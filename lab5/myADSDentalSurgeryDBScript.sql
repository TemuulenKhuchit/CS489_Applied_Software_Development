CREATE TABLE DENTIST (
  DENTIST_ID VARCHAR2(10) PRIMARY KEY,
  FIRST_NAME VARCHAR2(50),
  LAST_NAME VARCHAR2(50),
  PHONE VARCHAR2(15),
  EMAIL VARCHAR2(100),
  SPECIALIZATION VARCHAR2(50)
);

CREATE TABLE PATIENT (
  PATIENT_ID VARCHAR2(10) PRIMARY KEY,
  FIRST_NAME VARCHAR2(50),
  LAST_NAME VARCHAR2(50),
  PHONE VARCHAR2(15),
  EMAIL VARCHAR2(100),
  ADDRESS VARCHAR2(255),
  DOB DATE
);

CREATE TABLE SURGERY (
  SURGERY_NO VARCHAR2(10) PRIMARY KEY,
  NAME VARCHAR2(50),
  ADDRESS VARCHAR2(255),
  PHONE VARCHAR2(15)
);

CREATE TABLE APPOINTMENT (
  APPOINTMENT_ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  DENTIST_ID VARCHAR2(10) REFERENCES DENTIST(DENTIST_ID),
  PATIENT_ID VARCHAR2(10) REFERENCES PATIENT(PATIENT_ID),
  SURGERY_NO VARCHAR2(10) REFERENCES SURGERY(SURGERY_NO),
  APPOINTMENT_DATE DATE,
  APPOINTMENT_TIME VARCHAR2(10)
);


INSERT INTO DENTIST VALUES ('D001', 'Tony', 'Smith', '5551234', 'tony@ads.com', 'Orthodontist');
INSERT INTO DENTIST VALUES ('D002', 'Helen', 'Pearson', '5552345', 'helen@ads.com', 'Endodontist');
INSERT INTO DENTIST VALUES ('D003', 'Robin', 'Plevin', '5553456', 'robin@ads.com', 'Prosthodontist');

INSERT INTO PATIENT VALUES ('P100', 'Gillian', 'White', '5551111', 'gillian@x.com', '123 Main St', TO_DATE('1985-03-15','YYYY-MM-DD'));
INSERT INTO PATIENT VALUES ('P105', 'Jill', 'Bell', '5552222', 'jill@x.com', '23 Elm St', TO_DATE('1987-06-20','YYYY-MM-DD'));
INSERT INTO PATIENT VALUES ('P108', 'Ian', 'MacKay', '5553333', 'ian@x.com', '90 Pine St', TO_DATE('1984-09-02','YYYY-MM-DD'));
INSERT INTO PATIENT VALUES ('P110', 'John', 'Walker', '5554444', 'john@x.com', '47 Oak St', TO_DATE('1980-11-11','YYYY-MM-DD'));

INSERT INTO SURGERY VALUES ('S10', 'Central Surgery', '10 Center Rd', '555-1010');
INSERT INTO SURGERY VALUES ('S13', 'Eastside Surgery', '13 East Rd', '555-1313');
INSERT INTO SURGERY VALUES ('S15', 'Westside Surgery', '15 West Rd', '555-1515');

INSERT INTO APPOINTMENT (DENTIST_ID, PATIENT_ID, SURGERY_NO, APPOINTMENT_DATE, APPOINTMENT_TIME)
SELECT 'D001', 'P100', 'S15', TO_DATE('12-SEP-13','DD-MON-RR'), '10.00' FROM DUAL UNION ALL
SELECT 'D001', 'P105', 'S15', TO_DATE('12-SEP-13','DD-MON-RR'), '12.00' FROM DUAL UNION ALL
SELECT 'D002', 'P108', 'S10', TO_DATE('12-SEP-13','DD-MON-RR'), '10.00' FROM DUAL UNION ALL
SELECT 'D002', 'P108', 'S10', TO_DATE('14-SEP-13','DD-MON-RR'), '14.00' FROM DUAL UNION ALL
SELECT 'D003', 'P105', 'S15', TO_DATE('14-SEP-13','DD-MON-RR'), '16.30' FROM DUAL UNION ALL
SELECT 'D003', 'P110', 'S13', TO_DATE('15-SEP-13','DD-MON-RR'), '18.00' FROM DUAL;

COMMIT;


-- Query 1
SELECT * FROM DENTIST ORDER BY LAST_NAME;

-- Query 2
SELECT
  A.APPOINTMENT_ID,
  P.FIRST_NAME    AS PATIENT_FIRST,
  P.LAST_NAME     AS PATIENT_LAST,
  A.APPOINTMENT_DATE,
  A.APPOINTMENT_TIME,
  S.NAME          AS SURGERY_NAME
FROM
  APPOINTMENT A
  JOIN PATIENT  P ON A.PATIENT_ID = P.PATIENT_ID
  JOIN SURGERY  S ON A.SURGERY_NO = S.SURGERY_NO
WHERE
  A.DENTIST_ID = 'D001';

-- Query 3
SELECT
  D.FIRST_NAME    AS DENTIST,
  P.FIRST_NAME    AS PATIENT,
  A.APPOINTMENT_DATE,
  A.APPOINTMENT_TIME
FROM
  APPOINTMENT A
  JOIN DENTIST  D ON A.DENTIST_ID = D.DENTIST_ID
  JOIN PATIENT  P ON A.PATIENT_ID = P.PATIENT_ID
WHERE
  A.SURGERY_NO = 'S15';

-- Query 4
SELECT
  D.FIRST_NAME    AS DENTIST,
  S.NAME          AS SURGERY,
  A.APPOINTMENT_TIME
FROM
  APPOINTMENT A
  JOIN DENTIST  D ON A.DENTIST_ID = D.DENTIST_ID
  JOIN SURGERY  S ON A.SURGERY_NO = S.SURGERY_NO
WHERE
  A.PATIENT_ID = 'P108'
  AND A.APPOINTMENT_DATE = TO_DATE('12-SEP-13', 'DD-MON-RR');
